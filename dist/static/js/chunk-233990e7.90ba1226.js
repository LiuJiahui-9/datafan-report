/*! new version */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-233990e7"],{"129f":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},1450:function(t,e,i){},1806:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"dimension-relation-container flex-box--column"},[i("PageBreadcrumb",{attrs:{"title-list":t.titleList}},[i("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.onCreate}},[t._v(" 新增维度关系 ")])],1),i("div",{staticClass:"dimension-relation-search"},[i("a-input",{staticClass:"search__input",attrs:{"allow-clear":"",placeholder:"请输入左维度数据"},model:{value:t.search.leftDimensionName,callback:function(e){t.$set(t.search,"leftDimensionName",e)},expression:"search.leftDimensionName"}}),i("a-input",{staticClass:"search__input",attrs:{"allow-clear":"",placeholder:"请输入右维度数据"},model:{value:t.search.rightDimensionName,callback:function(e){t.$set(t.search,"rightDimensionName",e)},expression:"search.rightDimensionName"}}),i("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.onSearch(1)}}},[t._v("查询")])],1),i("div",{staticClass:"dimension-relation-table"},[i("SenseTable",t._b({ref:"senseTable",on:{"page-change":t.changePage},scopedSlots:t._u([{key:"associatedWayName",fn:function(e){var i=e.row;return[t._v(" "+t._s(t.getAssociatedWayName(i.associatedWay))+" ")]}},{key:"action",fn:function(e){var n=e.row;return[i("a-tooltip",{attrs:{title:"编辑"}},[i("a-button",{attrs:{type:"link"},on:{click:function(e){return t.onEdit(n)}}},[i("a-icon",{staticClass:"icon-btn",attrs:{type:"form"}})],1)],1),i("a-tooltip",{attrs:{title:"删除"}},[i("a-button",{attrs:{type:"link"},on:{click:function(e){return t.onDelete(n)}}},[i("a-icon",{staticClass:"icon-btn",attrs:{type:"delete"}})],1)],1)]}}])},"SenseTable",t.tableOptions,!1))],1),i("CreateDimensionRelation",{attrs:{"is-edit":t.isEdit,"dimension-relation-id":t.dimensionRelationId},on:{updataListInfo:t.initSearch},model:{value:t.isCreateModalShow,callback:function(e){t.isCreateModalShow=e},expression:"isCreateModalShow"}}),i("DeleteDimensionRelation",{attrs:{"dimension-relation-id":t.dimensionRelationId},on:{updataListInfo:t.initSearch},model:{value:t.isDeleteModalShow,callback:function(e){t.isDeleteModalShow=e},expression:"isDeleteModalShow"}})],1)},a=[],o=(i("ac1f"),i("841c"),i("d3b7"),i("bc42")),s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("a-base-modal",{attrs:{title:t.title,"confirm-loading":t.confirmLoading,width:"70%"},on:{ok:t.onOk,cancel:t.onCancel},model:{value:t.isModalShow,callback:function(e){t.isModalShow=e},expression:"isModalShow"}},[i("a-spin",{attrs:{spinning:t.modalLoading}},[i("a-form-model",{ref:"ruleForm",attrs:{model:t.form,rules:t.rules,colon:!1,"label-col":t.labelCol,"wrapper-col":t.wrapperCol}},[i("div",{staticClass:"from-item flex-box--wrap"},[i("a-form-model-item",{ref:"leftDimensionId",staticClass:"item",attrs:{label:"左维度名称",prop:"leftDimensionId"}},[i("a-select",{attrs:{"show-search":"","allow-clear":"",placeholder:"请选择左维度名称","filter-option":t.filterOption,disabled:t.isEdit},on:{change:t.leftDimensionchange},model:{value:t.form.leftDimensionId,callback:function(e){t.$set(t.form,"leftDimensionId",e)},expression:"form.leftDimensionId"}},t._l(t.dataDimensionList,(function(e){return i("a-select-option",{key:e.dimensionCode,attrs:{disabled:t.isLeftDisabled(e.dimensionCode)}},[t._v(" "+t._s(e.dimensionName)+" ")])})),1)],1),i("a-form-model-item",{ref:"rightDimensionId",staticClass:"item",attrs:{label:"右维度名称",prop:"rightDimensionId"}},[i("a-select",{attrs:{"show-search":"","allow-clear":"",placeholder:"请选择右维度名称",disabled:t.isEdit,"filter-option":t.filterOption},on:{change:t.rightDimensionchange},model:{value:t.form.rightDimensionId,callback:function(e){t.$set(t.form,"rightDimensionId",e)},expression:"form.rightDimensionId"}},t._l(t.dataDimensionList,(function(e){return i("a-select-option",{key:e.dimensionCode,attrs:{disabled:t.isRightDisabled(e.dimensionCode)}},[t._v(" "+t._s(e.dimensionName)+" ")])})),1)],1),i("a-form-model-item",{ref:"associatedWay",staticClass:"item",attrs:{label:"关联方式",prop:"associatedWay"}},[i("a-select",{attrs:{"show-search":"","allow-clear":"",placeholder:"请选择关联方式","filter-option":t.filterOption},model:{value:t.form.associatedWay,callback:function(e){t.$set(t.form,"associatedWay",e)},expression:"form.associatedWay"}},t._l(t.associatedWayList,(function(e){return i("a-select-option",{key:e.value},[t._v(" "+t._s(e.label)+" ")])})),1)],1)],1)]),i("div",{staticClass:"association-relationship"},[i("a-radio-group",{on:{change:t.onChangeRelation},model:{value:t.relationValue,callback:function(e){t.relationValue=e},expression:"relationValue"}},[i("a-radio",{style:t.radioStyle,attrs:{value:1}},[t._v(" 关联条件 "),i("span",{staticClass:"remarks-color"},[t._v("（ t1是左维度表别名，t2是右维度表别名 ）")])]),t._l(t.associatedCondition,(function(e,n){return i("div",{key:n,staticClass:"relationship-box flex-box flex-box--between-justify"},[i("div",{staticClass:"relation-t1"},[i("div",{staticClass:"relation-item flex-box--center-items flex-box--center-justify"},[t._v(" t1 ")]),i("div",{staticClass:"select-box flex-box--center-self"},[i("a-select",{staticClass:"t1__select flex-box--center-items flex-box--center-justify",attrs:{"show-search":"","allow-clear":"",placeholder:"请选择字段","filter-option":t.filterOption},model:{value:e.leftColumn,callback:function(i){t.$set(e,"leftColumn",i)},expression:"item.leftColumn"}},t._l(t.leftColumnList,(function(e){return i("a-select-option",{key:e.columnCode},[t._v(" "+t._s(e.columnName)+" ")])})),1),i("a-select",{staticClass:"t1__select",attrs:{"show-search":"","allow-clear":"",placeholder:"请选择计算符号"},model:{value:e.calculationSymbol,callback:function(i){t.$set(e,"calculationSymbol",i)},expression:"item.calculationSymbol"}},t._l(t.calculationSymbolList,(function(e,n){return i("a-select-option",{key:n,attrs:{value:e.value}},[t._v(" "+t._s(e.value)+" ")])})),1)],1)]),i("div",{staticClass:"relation-t1"},[i("div",{staticClass:"relation-item flex-box--center-items flex-box--center-justify"},[t._v(" t2 ")]),i("div",{staticClass:"select-box flex-box--center-self"},[i("a-select",{staticClass:"t1__select",attrs:{"show-search":"","allow-clear":"",placeholder:"请选择字段","filter-option":t.filterOption},model:{value:e.rightColumn,callback:function(i){t.$set(e,"rightColumn",i)},expression:"item.rightColumn"}},t._l(t.rightColumnList,(function(e){return i("a-select-option",{key:e.columnCode},[t._v(" "+t._s(e.columnName)+" ")])})),1)],1)]),i("div",{staticClass:"relation-btn"},[i("a-button",{staticClass:"plus-btn",attrs:{shape:"circle",ghost:"",type:"primary",icon:"plus",size:"small"},on:{click:t.onPlus}}),0!==n?i("a-button",{attrs:{shape:"circle",ghost:"",type:"primary",icon:"minus",size:"small"},on:{click:function(i){return t.onMinus(e)}}}):t._e()],1)])})),i("a-radio",{style:t.radioStyle,attrs:{value:2}},[t._v(" 自定义表达式 "),i("span",{staticClass:"remarks-color"},[t._v("（ t1是左维度表别名，t2是右维度表别名 ）")])]),2===t.relationValue?i("a-textarea",{staticClass:"expression__input",attrs:{rows:4},model:{value:t.customExpression,callback:function(e){t.customExpression=e},expression:"customExpression"}}):t._e()],2)],1)],1)],1)],1)},l=[],c=(i("a9e3"),i("159b"),i("a434"),i("7db0"),i("ff64")),r=(i("99af"),i("7424")),u=i("155f"),d="dimensionRelation​",m="".concat(r["METIS"],"/").concat(d),f={getDimensionRelationList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(u["i"])("".concat(m,"/list"),u["a"].GET,{params:t})},dimensionRelationDetail:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(u["i"])("".concat(m,"/").concat(t),u["a"].GET)},createDimensionRelation:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(u["i"])("".concat(m,"/add"),u["a"].POST,t)},updateDimensionRelation:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(u["i"])("".concat(m,"/update"),u["a"].POST,t)},deleteDimensionRelation:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(u["i"])("".concat(m,"/delete/").concat(t),u["a"].DELETE)}},h=f,p=i("d8fe"),g={name:"CreateDimensionRelationship",model:{prop:"visible",event:"change"},props:{visible:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1},dimensionRelationId:{type:Number,default:null}},data:function(){return{modalLoading:!1,confirmLoading:!1,isModalShow:!1,labelCol:{span:6},wrapperCol:{span:16},form:{id:""},customExpression:"",associatedWayList:[{value:"inner",label:"内关联"},{value:"left",label:"左关联"},{value:"right",label:"右关联"},{value:"all",label:"全关联"}],dataDimensionList:[],rules:{leftDimensionId:[{required:!0,message:"请选择左维度数据",trigger:"change"}],rightDimensionId:[{required:!0,message:"请选择右维度数据",trigger:"change"}],associatedWay:[{required:!0,message:"请选择关联方式",trigger:"change"}]},relationValue:1,radioStyle:{display:"block",height:"30px",lineHeight:"30px"},associatedCondition:[{leftColumn:"",calculationSymbol:"",rightColumn:""}],calculationSymbolList:[{value:"="},{value:"!="},{value:">"},{value:">="},{value:"<"},{value:"<="}],leftColumnList:[],rightColumnList:[]}},computed:{title:function(){var t="新增数据维度";return this.isEdit&&(t="编辑数据维度"),t}},watch:{visible:function(t){this.isModalShow=t,t&&this.init()},customExpression:function(t){this.relationValue=1,t&&(this.relationValue=2)},"form.leftDimensionId":function(t,e){e&&t!==e&&this.clearLeftColumn()},"form.rightDimensionId":function(t,e){e&&t!==e&&this.clearRightColumn()}},methods:{init:function(){this.initSearch(),this.isEdit&&this.isEditInfo()},isEditInfo:function(){var t=this,e=this.dimensionRelationId;this.modalLoading=!0,h.dimensionRelationDetail(e).then((function(e){t.form=e.data.content,t.leftDimensionchange(t.form.leftDimensionId),t.rightDimensionchange(t.form.rightDimensionId),t.customExpression=e.data.content.customExpression,t.associatedCondition=e.data.content.associatedCondition})).catch((function(){t.$message.warn("获取维度关系信息失败")})).finally((function(){t.modalLoading=!1}))},isLeftDisabled:function(t){var e=!1,i=this.form.rightDimensionId;return i===t&&(e=!0),e},isRightDisabled:function(t){var e=!1,i=this.form.leftDimensionId;return i===t&&(e=!0),e},initSearch:function(){var t=this,e={page:999,pageSize:999};c["a"].getDataDimensionList(e).then((function(e){t.dataDimensionList=e.data.content.list})).catch((function(){t.$message.warn("获取左右数据维度失败")}))},leftDimensionchange:function(t){var e=this,i={dimensionCode:t,page:999,pageSize:999};p["a"].getDimensionColumnList(i).then((function(t){e.leftColumnList=t.data.content.list})).catch((function(){e.$message.warn("获取左维度字段失败")}))},clearLeftColumn:function(){this.associatedCondition.forEach((function(t){t.leftColumn=""}))},rightDimensionchange:function(t){var e=this,i={dimensionCode:t,page:999,pageSize:999};p["a"].getDimensionColumnList(i).then((function(t){e.rightColumnList=t.data.content.list})).catch((function(){e.$message.warn("获取右维度字段失败")}))},clearRightColumn:function(){this.associatedCondition.forEach((function(t){t.rightColumn=""}))},filterOption:function(t,e){return e.componentOptions.children[0].text.toLowerCase().indexOf(t.toLowerCase())>=0},onPlus:function(){this.associatedCondition.push({leftColumn:"",calculationSymbol:"",rightColumn:""})},onMinus:function(t){var e=this.associatedCondition.indexOf(t);-1!==e&&this.associatedCondition.splice(e,1)},onChangeRelation:function(t){2===t.target.value&&(this.associatedCondition=[{leftColumn:"",calculationSymbol:"",rightColumn:""}]),1===t.target.value&&(this.customExpression="")},isCheckRelationshipPass:function(){var t=!1,e=!1;return this.associatedCondition.forEach((function(t){t.leftColumn&&t.calculationSymbol&&t.rightColumn&&(e=!0)})),(this.customExpression||e)&&(t=!0),t},createSubmit:function(){var t=this,e=this.form,i=e.associatedWay,n=e.leftDimensionId,a=e.rightDimensionId,o=this.dataDimensionList.find((function(t){return t.id===n})).dimensionName,s=this.dataDimensionList.find((function(t){return t.id===a})).dimensionName,l={associatedWay:i,leftDimensionId:n,leftDimensionName:o,rightDimensionId:a,rightDimensionName:s,customExpression:this.customExpression,associatedCondition:this.associatedCondition};this.confirmLoading=!0,h.createDimensionRelation(l).then((function(e){t.$message.success(e.data.content),t.onClose(),t.$emit("updataListInfo")})).catch((function(){t.$message.warn("新增维度关系提交失败")})).finally((function(){t.confirmLoading=!1}))},editSubmit:function(){var t=this,e=this.form,i=e.id,n=e.associatedWay,a={id:i,associatedWay:n,customExpression:this.customExpression,associatedCondition:this.associatedCondition};this.confirmLoading=!0,h.updateDimensionRelation(a).then((function(e){t.$message.success(e.data.content),t.onClose(),t.$emit("updataListInfo")})).catch((function(){t.$message.warn("编辑维度关系提交失败")})).finally((function(){t.confirmLoading=!1}))},onOk:function(){var t=this,e=this.isCheckRelationshipPass();this.$refs.ruleForm.validate((function(i){i&&e?t.isEdit?t.editSubmit():t.createSubmit():t.$message.warn("请选择关联条件或填写自定义表达式")}))},onCancel:function(){this.onClose()},onClose:function(){this.$refs.ruleForm.resetFields(),this.form={},this.leftColumnList=[],this.rightColumnList=[],this.dataDimensionList=[],this.associatedCondition=[{leftColumn:"",calculationSymbol:"",rightColumn:""}],this.customExpression="",this.$emit("change")}}},v=g,b=(i("8654"),i("2877")),C=Object(b["a"])(v,s,l,!1,null,"465e96c7",null),D=C.exports,x=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("a-base-modal",{attrs:{title:t.title,width:"45%","confirm-loading":t.confirmLoading},on:{ok:t.onOk,cancel:t.onCancel},model:{value:t.isDeteleModalShow,callback:function(e){t.isDeteleModalShow=e},expression:"isDeteleModalShow"}},[i("a-alert",{attrs:{message:t.message,banner:""}})],1)],1)},y=[],S={model:{prop:"visible",event:"change"},props:{visible:{type:Boolean,default:!1},dimensionRelationId:{type:Number,default:null}},data:function(){return{title:"删除数据维度",isDeteleModalShow:!1,confirmLoading:!1,message:"删除维度关系，意味着基于此维度关系事件无法运行，请务必谨慎操作！"}},watch:{visible:function(t){this.isDeteleModalShow=t}},methods:{onOk:function(){var t=this,e=this.dimensionRelationId;this.confirmLoading=!0,h.deleteDimensionRelation(e).then((function(e){t.$message.success(e.data.content),t.onClose(),t.$emit("updataListInfo")})).catch((function(e){t.$message.warn(e.data.msg)})).finally((function(){t.confirmLoading=!1}))},onCancel:function(){this.onClose()},onClose:function(){this.$emit("change")}}},w=S,L=(i("2ed7"),Object(b["a"])(w,x,y,!1,null,"ed9f4a28",null)),_=L.exports,E={name:"DimensionRelation",components:{PageBreadcrumb:o["a"],CreateDimensionRelation:D,DeleteDimensionRelation:_},data:function(){return{titleList:[{name:"知识库管理"},{name:"维度关系管理"}],search:{leftDimensionName:"",rightDimensionName:""},tableOptions:{height:"auto",emptyRender:{size:"small"},pagerConfig:{pageSizes:[10,20,50,100],total:0,currentPage:1,pageSize:10},columns:[{title:"左数据维度",field:"leftDimensionName"},{title:"关联方式",field:"associatedWay",slots:{default:"associatedWayName"}},{title:"右数据维度",field:"rightDimensionName"},{title:"关联表达式",field:"customExpression"},{title:"创建人",field:"createUserName"},{title:"创建时间",field:"createTime"},{title:"操作",field:"operation",align:"center",fixed:"right",slots:{default:"action"}}],data:[],loading:!1},isCreateModalShow:!1,isEdit:!1,isDeleteModalShow:!1,dimensionRelationId:null}},mounted:function(){this.initSearch()},methods:{getParams:function(){var t=this.search,e=t.leftDimensionName,i=t.rightDimensionName,n=this.tableOptions.pagerConfig,a=n.currentPage,o=n.pageSize,s={leftDimensionName:e,rightDimensionName:i,page:a,pageSize:o};return s},initSearch:function(){var t=this,e=this.getParams();this.tableOptions.loading=!0,h.getDimensionRelationList(e).then((function(e){t.tableOptions.data=e.data.content.list,t.tableOptions.pagerConfig.total=e.data.content.total})).catch((function(){t.$message.warn("查询维度关系列表失败")})).finally((function(){t.tableOptions.loading=!1}))},changePage:function(t){this.tableOptions.pagerConfig.currentPage=t.currentPage,this.tableOptions.pagerConfig.pageSize=t.pageSize,this.initSearch()},onSearch:function(t){this.tableOptions.pagerConfig.currentPage=t,this.initSearch()},getAssociatedWayName:function(t){var e={left:"左关联",right:"右关联",inner:"内关联",all:"全关联"};return e[t]},onCreate:function(){this.isEdit=!1,this.dimensionRelationId=null,this.isCreateModalShow=!0},onEdit:function(t){this.isEdit=!0,this.dimensionRelationId=t.id,this.isCreateModalShow=!0},onDelete:function(t){this.dimensionRelationId=t.id,this.isDeleteModalShow=!0}}},k=E,I=(i("8a1a"),Object(b["a"])(k,n,a,!1,null,"cbe0b798",null));e["default"]=I.exports},"2ed7":function(t,e,i){"use strict";i("1450")},3996:function(t,e,i){},7720:function(t,e,i){},"841c":function(t,e,i){"use strict";var n=i("d784"),a=i("825a"),o=i("1d80"),s=i("129f"),l=i("577e"),c=i("14c3");n("search",(function(t,e,i){return[function(e){var i=o(this),n=void 0==e?void 0:e[t];return void 0!==n?n.call(e,i):new RegExp(e)[t](l(i))},function(t){var n=a(this),o=l(t),r=i(e,n,o);if(r.done)return r.value;var u=n.lastIndex;s(u,0)||(n.lastIndex=0);var d=c(n,o);return s(n.lastIndex,u)||(n.lastIndex=u),null===d?-1:d.index}]}))},8654:function(t,e,i){"use strict";i("7720")},"8a1a":function(t,e,i){"use strict";i("3996")},a3aa:function(t,e,i){},bc42:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"page-title-container"},[i("div",{staticClass:"page-title"},[i("a-breadcrumb",[i("span",{attrs:{slot:"separator"},slot:"separator"},[t._v(" > ")]),t._l(t.titleList,(function(e,n){return i("a-breadcrumb-item",{key:n},[t._v(" "+t._s(e.name)+" ")])}))],2)],1),i("div",{staticClass:"page-operation"},[t._t("default")],2)])},a=[],o={name:"PageBreadcrumb",props:{titleList:{type:Array,default:function(){return[]}}},data:function(){return{}}},s=o,l=(i("ce26"),i("2877")),c=Object(l["a"])(s,n,a,!1,null,"2f9030fc",null);e["a"]=c.exports},ce26:function(t,e,i){"use strict";i("a3aa")},d8fe:function(t,e,i){"use strict";i("99af");var n=i("7424"),a=i("155f"),o="dimensionColumn",s="".concat(n["METIS"],"/").concat(o),l={getDimensionColumnList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(a["i"])("".concat(s,"/list"),a["a"].GET,{params:t})},selectListByDimensionIds:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(a["i"])("".concat(s,"/selectListByDimensionIds"),a["a"].POST,t)}};e["a"]=l},ff64:function(t,e,i){"use strict";i("99af");var n=i("7424"),a=i("155f"),o="dataDimension",s="".concat(n["METIS"],"/").concat(o),l={getDataDimensionList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(a["i"])("".concat(s,"/list"),a["a"].GET,{params:t})},createDataDimension:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(a["i"])("".concat(s,"/add"),a["a"].POST,t)},updateDataDimension:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(a["i"])("".concat(s,"/update"),a["a"].POST,t)},deleteDataDimension:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(a["i"])("".concat(s,"/delete/").concat(t),a["a"].DELETE)},detailDataDimension:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(a["i"])("".concat(s,"/detail"),a["a"].GET,{params:t})},getDimensionCode:function(){return Object(a["i"])("".concat(s,"/getDimensionCode"),a["a"].GET)},checkDimensionCode:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(a["i"])("".concat(s,"/checkDimensionCode"),a["a"].GET,{params:t})},getAssetPackageList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(a["i"])("".concat(s,"/assetPackageList"),a["a"].GET,{params:t})},getAssetItemList:function(t){return Object(a["i"])("".concat(s,"/assetItemList"),a["a"].GET,{params:t})},getDimensionChild:function(t){return Object(a["i"])("".concat(s,"/childList"),a["a"].GET,{params:t})}};e["a"]=l}}]);