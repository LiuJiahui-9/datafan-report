/*! new version */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5d615230"],{"18a2":function(e,t,a){"use strict";a("5aa9")},"4f3f":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"data-dimension-container"},[a("PageBreadcrumb",{attrs:{"title-list":e.titleList}},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.onCreate}},[e._v(" 新增数据维度 ")])],1),a("div",{staticClass:"container-serach"},[a("a-input",{staticClass:"search__input",attrs:{"allow-clear":"",placeholder:"请输入数据维度"},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}}),a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSearch(1)}}},[e._v("查询")])],1),a("div",{staticClass:"table-container"},[a("SenseTable",e._b({ref:"senseTable",on:{"page-change":e.changePage},scopedSlots:e._u([{key:"nameAction",fn:function(t){var i=t.row;return[a("span",[a("a-button",{attrs:{type:"link"},on:{click:function(t){return e.onDetail(i)}}},[e._v(e._s(i.dimensionName))])],1)]}},{key:"action",fn:function(t){var i=t.row;return[a("a-tooltip",{attrs:{title:"编辑"}},[a("a-button",{attrs:{type:"link"},on:{click:function(t){return e.onEdit(i)}}},[a("a-icon",{staticClass:"icon-btn",attrs:{type:"form"}})],1)],1),a("a-tooltip",{attrs:{title:"删除"}},[a("a-button",{attrs:{type:"link"},on:{click:function(t){return e.onDelete(i)}}},[a("a-icon",{staticClass:"icon-btn",attrs:{type:"delete"}})],1)],1)]}}])},"SenseTable",e.tableOptions,!1))],1),a("CreateDataDimension",{attrs:{"is-edit":e.isEdit,"data-dimension-id":e.dataDimensionId},on:{updateListInfo:e.initSearch},model:{value:e.isAddModalShow,callback:function(t){e.isAddModalShow=t},expression:"isAddModalShow"}}),a("DeleteDataDimension",{attrs:{"data-dimension-id":e.dataDimensionId},on:{updateListInfo:e.initSearch},model:{value:e.isDeleteModalShow,callback:function(t){e.isDeleteModalShow=t},expression:"isDeleteModalShow"}}),a("DetailDataDimension",{attrs:{"data-dimension-id":e.dataDimensionId},model:{value:e.isDetailModalShow,callback:function(t){e.isDetailModalShow=t},expression:"isDetailModalShow"}})],1)},n=[],o=(a("d3b7"),a("bc42")),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-base-modal",{attrs:{title:e.title,"confirm-loading":e.confirmLoading,width:"55%"},on:{ok:e.onOk,cancel:e.onCancel},model:{value:e.isModalShow,callback:function(t){e.isModalShow=t},expression:"isModalShow"}},[a("a-spin",{attrs:{spinning:e.modalLoading}},[a("a-form-model",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol,colon:!1}},[a("a-form-model-item",{ref:"dimensionName",attrs:{label:"维度名称",prop:"dimensionName"}},[a("a-input",{attrs:{"allow-clear":"",placeholder:"请输入数据维度"},model:{value:e.form.dimensionName,callback:function(t){e.$set(e.form,"dimensionName",t)},expression:"form.dimensionName"}})],1),a("a-form-model-item",{ref:"dimensionCode",attrs:{label:"维度编码",prop:"dimensionCode"}},[a("a-input",{attrs:{disabled:e.isEdit,"allow-clear":"",placeholder:"请输入维度编码"},model:{value:e.form.dimensionCode,callback:function(t){e.$set(e.form,"dimensionCode",t)},expression:"form.dimensionCode"}})],1),a("a-form-model-item",{ref:"apCode",attrs:{label:"关联数据资产包",prop:"apCode"}},[a("a-select",{attrs:{"show-search":"","allow-clear":"",placeholder:"请关联数据资产包","filter-option":e.filterOption},on:{change:e.getAssetItemList},model:{value:e.form.apCode,callback:function(t){e.$set(e.form,"apCode",t)},expression:"form.apCode"}},e._l(e.assetData,(function(t){return a("a-select-option",{key:t.apCode},[e._v(" "+e._s(t.apName)+" ")])})),1)],1)],1),a("div",{staticClass:"data-list"},[a("div",{staticClass:"list-title"},[e._v("数据项清单")]),a("div",{staticClass:"table-container"},[a("SenseTable",e._b({ref:"senseTable",on:{"page-change":e.changePage}},"SenseTable",e.tableOptions,!1))],1)])],1)],1)],1)},l=[],r=(a("a9e3"),a("7db0"),a("ff64")),c={name:"CreateDataDimension",model:{prop:"visible",event:"change"},props:{visible:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1},dataDimensionId:{type:Number,default:0}},data:function(){var e=this,t=function(t,a,i){!e.isEdit&&a?r["a"].checkDimensionCode({code:a}).then((function(e){i()})).catch((function(e){return i(new Error(e.data.msg))})):i()};return{modalLoading:!1,confirmLoading:!1,isModalShow:!1,labelCol:{span:6},wrapperCol:{span:16},form:{id:"",dimensionName:"",dimensionCode:""},assetData:[],rules:{dimensionName:[{required:!0,message:"请输入数据维度",trigger:"blur"},{max:50,message:"名称长度不超过50",trigger:"blur"}],dimensionCode:[{required:!0,message:"请输入维度编码",trigger:"blur"},{validator:t,trigger:"change"}],apCode:[{required:!0,message:"请选择数据资产包",trigger:"change"}]},tableOptions:{emptyRender:{size:"small"},pagerConfig:{pageSizes:[10,20,50,100],total:0,currentPage:1,pageSize:10},loading:!1,data:[],columns:[{title:"序号",type:"seq",align:"center",width:100},{title:"字段英文名",align:"center",field:"itemCode",showOverflow:!0},{title:"字段中文名",align:"center",field:"itemName",showOverflow:!0},{title:"数据类型",align:"center",field:"dataType",showOverflow:!0}]}}},computed:{title:function(){var e="新增数据维度";return this.isEdit&&(e="编辑数据维度"),e}},watch:{visible:function(e){this.isModalShow=e,e&&this.init()}},methods:{init:function(){this.getAssetPackageList(),this.getDimensionCode(),this.isEdit&&this.isEditInfo()},isEditInfo:function(){var e=this,t={id:this.dataDimensionId};this.modalLoading=!0,r["a"].detailDataDimension(t).then((function(t){e.form=t.data.content,e.getAssetItemList()})).catch((function(){e.$message.warn("获取数据维度信息失败")})).finally((function(){e.modalLoading=!1}))},getDimensionCode:function(){var e=this;r["a"].getDimensionCode().then((function(t){e.form.dimensionCode=t.data.content})).catch((function(){e.$message.warn("获取默认维度编码失败")}))},getAssetPackageList:function(){var e=this,t={dimensionId:this.dataDimensionId};r["a"].getAssetPackageList(t).then((function(t){e.assetData=t.data.content})).catch((function(){e.$message.warn("获取关联数据资产包失败")}))},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},getAssetItemParams:function(){var e={apCode:this.form.apCode,page:this.tableOptions.pagerConfig.currentPage,pageSize:this.tableOptions.pagerConfig.pageSize};return e},getAssetItemList:function(){var e=this,t=this.getAssetItemParams();this.tableOptions.loading=!0,r["a"].getAssetItemList(t).then((function(t){e.tableOptions.data=t.data.content.list,e.tableOptions.pagerConfig.total=t.data.content.total})).catch((function(){e.$message.warn("获取数据项清单失败")})).finally((function(){e.tableOptions.loading=!1}))},changePage:function(e){this.tableOptions.pagerConfig.currentPage=e.currentPage,this.tableOptions.pagerConfig.pageSize=e.pageSize,this.getAssetItemList()},createSubmit:function(){var e=this,t=this.form,a=t.apCode,i=t.dimensionCode,n=t.dimensionName,o=this.assetData.find((function(e){return e.apCode===a})).apName,s={apCode:a,apName:o,dimensionCode:i,dimensionName:n};this.confirmLoading=!0,r["a"].createDataDimension(s).then((function(t){e.$message.success(t.data.content),e.onClose(),e.$emit("updateListInfo")})).catch((function(){e.$message.warn("新增数据维度提交失败")})).finally((function(){e.confirmLoading=!1}))},editSubmit:function(){var e=this,t=this.form,a=t.apCode,i=t.dimensionCode,n=t.dimensionName,o=this.assetData.find((function(e){return e.apCode===a})).apName,s={apCode:a,apName:o,dimensionCode:i,dimensionName:n,id:this.dataDimensionId};this.confirmLoading=!0,r["a"].updateDataDimension(s).then((function(t){e.$message.success(t.data.content),e.onClose(),e.$emit("updateListInfo")})).catch((function(){e.$message.warn("修改数据维度提交失败")})).finally((function(){e.confirmLoading=!1}))},onOk:function(){var e=this;this.$refs.ruleForm.validate((function(t){t&&(e.isEdit?e.editSubmit():e.createSubmit())}))},onCancel:function(){this.onClose()},onClose:function(){this.$refs.ruleForm.resetFields(),this.tableOptions.data=[],this.form={},this.$emit("change")}}},d=c,m=(a("d4c7"),a("2877")),u=Object(m["a"])(d,s,l,!1,null,"185af772",null),f=u.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-base-modal",{attrs:{title:e.title,width:"45%","confirm-loading":e.confirmLoading},on:{ok:e.onOk,cancel:e.onCancel},model:{value:e.isDeleteModalShow,callback:function(t){e.isDeleteModalShow=t},expression:"isDeleteModalShow"}},[a("a-alert",{attrs:{message:e.message,banner:""}})],1)],1)},p=[],g={name:"DeleteDataDimension",model:{prop:"visible",event:"change"},props:{visible:{type:Boolean,default:!1},dataDimensionId:{type:Number,default:0}},data:function(){return{title:"删除数据维度",isDeleteModalShow:!1,confirmLoading:!1,message:"删除数据维度，意味着基于此数据维度测算的事件无法运行，请务必谨慎操作！"}},watch:{visible:function(e){this.isDeleteModalShow=e}},methods:{onOk:function(){var e=this;this.confirmLoading=!0,r["a"].deleteDataDimension(this.dataDimensionId).then((function(t){e.$message.success(t.data.content),e.onClose(),e.$emit("updateListInfo")})).catch((function(t){e.$message.warn(t.data.msg)})).finally((function(){e.confirmLoading=!1}))},onCancel:function(){this.onClose()},onClose:function(){this.$emit("change")}}},b=g,D=(a("b5a3"),Object(m["a"])(b,h,p,!1,null,"7d3c1c88",null)),C=D.exports,v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-base-modal",{attrs:{title:e.title,width:"55%"},on:{ok:e.onOk,cancel:e.onCancel},model:{value:e.isDetailModalShow,callback:function(t){e.isDetailModalShow=t},expression:"isDetailModalShow"}},[a("a-spin",{attrs:{spinning:e.modalLoading}},[a("div",{staticClass:"detail-text flex-box--row flex-box--between-justify"},[a("div",[e._v(" 维度名称："+e._s(e.detailData.dimensionName)+" ")]),a("div",[e._v(" 维度编码："+e._s(e.detailData.dimensionCode)+" ")]),a("div",[e._v(" 关联资产包："+e._s(e.detailData.apName)+" ")])]),a("div",{staticClass:"detail-table"},[a("div",{staticClass:"list-title"},[e._v("数据项清单")]),a("div",{staticClass:"table-container"},[a("SenseTable",e._b({ref:"senseTable",on:{"page-change":e.changePage}},"SenseTable",e.tableOptions,!1))],1)])])],1)],1)},w=[],O={name:"DetailDataDimension",model:{prop:"visible",event:"change"},props:{visible:{type:Boolean,default:!1},dataDimensionId:{type:Number,default:0}},data:function(){return{modalLoading:!1,title:"数据维度详情",isDetailModalShow:!1,tableOptions:{emptyRender:{size:"small"},pagerConfig:{pageSizes:[10,20,50,100],total:0,currentPage:1,pageSize:10},loading:!1,columns:[{title:"序号",type:"seq",align:"center",width:100},{title:"字段英文名",field:"itemName",align:"center",showOverflow:!0},{title:"字段中文名",align:"center",field:"itemCode",showOverflow:!0},{title:"数据类型",align:"center",field:"dataType",showOverflow:!0}],data:[]},detailData:{}}},watch:{visible:function(e){this.isDetailModalShow=e,e&&this.init()}},methods:{init:function(){var e=this,t={id:this.dataDimensionId};this.modalLoading=!0,r["a"].detailDataDimension(t).then((function(t){e.detailData=t.data.content,e.tableOptions.data=t.data.content.items,e.tableOptions.pagerConfig.total=t.data.content.items.length})).catch((function(){e.$message.warn("查询数据维度详情失败")})).finally((function(){e.modalLoading=!1}))},getAssetItemParams:function(){var e={apCode:this.detailData.apCode,page:this.tableOptions.pagerConfig.currentPage,pageSize:this.tableOptions.pagerConfig.pageSize};return e},getAssetItemList:function(){var e=this,t=this.getAssetItemParams();this.tableOptions.loading=!0,r["a"].getAssetItemList(t).then((function(t){e.tableOptions.data=t.data.content.list,e.tableOptions.pagerConfig.total=t.data.content.total})).catch((function(){e.$message.warn("获取数据项清单失败")})).finally((function(){e.tableOptions.loading=!1}))},changePage:function(e){this.tableOptions.pagerConfig.currentPage=e.currentPage,this.tableOptions.pagerConfig.pageSize=e.pageSize,this.getAssetItemList()},onOk:function(){this.onClose()},onCancel:function(){this.onClose()},onClose:function(){this.detailData={},this.data=[],this.$emit("change")}}},S=O,L=(a("18a2"),Object(m["a"])(S,v,w,!1,null,"f59ced82",null)),k=L.exports,I={name:"DataDimension",components:{PageBreadcrumb:o["a"],CreateDataDimension:f,DeleteDataDimension:C,DetailDataDimension:k},data:function(){return{searchValue:"",titleList:[{name:"知识库管理"},{name:"数据维度管理"}],tableOptions:{height:"auto",emptyRender:{size:"small"},pagerConfig:{pageSizes:[10,20,50,100],total:0,currentPage:1,pageSize:10},loading:!1,data:[],columns:[{title:"数据维度名称",field:"dimensionName",showOverflow:!0,slots:{default:"nameAction"}},{title:"数据维度编码",field:"dimensionCode",showOverflow:!0},{title:"数据资产名称",field:"apName",showOverflow:!0},{title:"创建人",field:"createUserName",showOverflow:!0},{title:"创建时间",field:"createTime",showOverflow:!0},{title:"操作",width:120,align:"center",fixed:"right",slots:{default:"action"}}]},isAddModalShow:!1,isDeleteModalShow:!1,isEdit:!1,isDetailModalShow:!1,detailData:{},dataDimensionId:0}},mounted:function(){this.initSearch()},methods:{getParams:function(){var e={dimensionName:this.searchValue,page:this.tableOptions.pagerConfig.currentPage,pageSize:this.tableOptions.pagerConfig.pageSize};return e},initSearch:function(){var e=this,t=this.getParams();this.tableOptions.loading=!0,r["a"].getDataDimensionList(t).then((function(t){e.tableOptions.data=t.data.content.list,e.tableOptions.pagerConfig.total=t.data.content.total})).catch((function(){e.$message.warn("数据维度列表查询失败")})).finally((function(){e.tableOptions.loading=!1}))},changePage:function(e){this.tableOptions.pagerConfig.currentPage=e.currentPage,this.tableOptions.pagerConfig.pageSize=e.pageSize,this.initSearch()},onSearch:function(e){this.tableOptions.pagerConfig.currentPage=e,this.initSearch()},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},onCreate:function(){this.dataDimensionId=null,this.isAddModalShow=!0,this.isEdit=!1},onEdit:function(e){this.dataDimensionId=e.id,this.isEdit=!0,this.isAddModalShow=!0},onDetail:function(e){this.dataDimensionId=e.id,this.isDetailModalShow=!0},onDelete:function(e){this.dataDimensionId=e.id,this.isDeleteModalShow=!0}}},y=I,_=(a("88d5"),Object(m["a"])(y,i,n,!1,null,"2fab034e",null));t["default"]=_.exports},"5aa9":function(e,t,a){},"88d5":function(e,t,a){"use strict";a("d659")},a3aa:function(e,t,a){},b5a3:function(e,t,a){"use strict";a("eaef")},bc42:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-title-container"},[a("div",{staticClass:"page-title"},[a("a-breadcrumb",[a("span",{attrs:{slot:"separator"},slot:"separator"},[e._v(" > ")]),e._l(e.titleList,(function(t,i){return a("a-breadcrumb-item",{key:i},[e._v(" "+e._s(t.name)+" ")])}))],2)],1),a("div",{staticClass:"page-operation"},[e._t("default")],2)])},n=[],o={name:"PageBreadcrumb",props:{titleList:{type:Array,default:function(){return[]}}},data:function(){return{}}},s=o,l=(a("ce26"),a("2877")),r=Object(l["a"])(s,i,n,!1,null,"2f9030fc",null);t["a"]=r.exports},ce26:function(e,t,a){"use strict";a("a3aa")},d4c7:function(e,t,a){"use strict";a("e494")},d659:function(e,t,a){},e494:function(e,t,a){},eaef:function(e,t,a){},ff64:function(e,t,a){"use strict";a("99af");var i=a("7424"),n=a("155f"),o="dataDimension",s="".concat(i["METIS"],"/").concat(o),l={getDataDimensionList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["i"])("".concat(s,"/list"),n["a"].GET,{params:e})},createDataDimension:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["i"])("".concat(s,"/add"),n["a"].POST,e)},updateDataDimension:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["i"])("".concat(s,"/update"),n["a"].POST,e)},deleteDataDimension:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(n["i"])("".concat(s,"/delete/").concat(e),n["a"].DELETE)},detailDataDimension:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["i"])("".concat(s,"/detail"),n["a"].GET,{params:e})},getDimensionCode:function(){return Object(n["i"])("".concat(s,"/getDimensionCode"),n["a"].GET)},checkDimensionCode:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["i"])("".concat(s,"/checkDimensionCode"),n["a"].GET,{params:e})},getAssetPackageList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["i"])("".concat(s,"/assetPackageList"),n["a"].GET,{params:e})},getAssetItemList:function(e){return Object(n["i"])("".concat(s,"/assetItemList"),n["a"].GET,{params:e})},getDimensionChild:function(e){return Object(n["i"])("".concat(s,"/childList"),n["a"].GET,{params:e})}};t["a"]=l}}]);